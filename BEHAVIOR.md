# Deks 1.0 로봇 행동 정의

## 🤖 기본 이동 행동

### 1. 전진 (Move Forward)
```python
def move_forward(speed=50, duration=2000):
    """
    로봇을 앞으로 이동시킵니다
    - speed: 모터 속도 (0-100)
    - duration: 이동 시간 (ms)
    """
    # LED: 웃는 표정
    # 버저: 상승 음계
    # 동작: 양쪽 모터 동일 속도로 전진
```

**자연어 명령어**: "앞으로 가줘", "전진해", "이동해", "앞으로 가"

### 2. 좌회전 (Turn Left)
```python
def turn_left(angle=90, speed=40):
    """
    로봇을 왼쪽으로 회전시킵니다
    - angle: 회전 각도 (도)
    - speed: 모터 속도 (0-100)
    """
    # LED: 왼쪽 화살표 표정
    # 버저: 왼쪽 회전 음향
    # 동작: 오른쪽 모터만 전진, 왼쪽 모터 정지
```

**자연어 명령어**: "왼쪽으로 돌아", "좌회전", "왼쪽으로"

### 3. 우회전 (Turn Right)
```python
def turn_right(angle=90, speed=40):
    """
    로봇을 오른쪽으로 회전시킵니다
    - angle: 회전 각도 (도)
    - speed: 모터 속도 (0-100)
    """
    # LED: 오른쪽 화살표 표정
    # 버저: 오른쪽 회전 음향
    # 동작: 왼쪽 모터만 전진, 오른쪽 모터 정지
```

**자연어 명령어**: "오른쪽으로 돌아", "우회전", "오른쪽으로"

### 4. 제자리 회전 (Spin)
```python
def spin(direction="clockwise", speed=30):
    """
    로봇을 제자리에서 회전시킵니다
    - direction: 회전 방향 ("clockwise", "counterclockwise")
    - speed: 모터 속도 (0-100)
    """
    # LED: 회전 애니메이션
    # 버저: 회전 음향 효과
    # 동작: 양쪽 모터 반대 방향으로 회전
```

**자연어 명령어**: "빙글빙글 돌아", "회전해", "돌아"

### 5. 정지 (Stop)
```python
def stop():
    """
    로봇을 즉시 정지시킵니다
    """
    # LED: 중립 표정
    # 버저: 정지 음향
    # 동작: 모든 모터 정지
```

**자연어 명령어**: "정지", "멈춰", "그만", "정지해"

## 🛡️ 안전 행동

### 1. 낙하 방지 (Drop Prevention)
```python
def emergency_stop():
    """
    낙하 감지 시 즉시 정지하고 안전 동작을 수행합니다
    """
    # LED: 경고 표정 (빨간색 깜빡임)
    # 버저: 경고음
    # 동작: 즉시 정지 → 180도 회전 → 전진
```

**트리거 조건**: 적외선 센서 값 > 800 (낙하 감지)

### 2. 장애물 회피 (Obstacle Avoidance)
```python
def avoid_obstacle():
    """
    전방 장애물을 감지하고 회피합니다
    """
    # LED: 주의 표정
    # 버저: 장애물 감지음
    # 동작: 정지 → 랜덤 방향 회전 → 전진
```

**트리거 조건**: 적외선 센서 값 > 600 (장애물 감지)

### 3. 안전 모드 진입 (Safe Mode)
```python
def enter_safe_mode():
    """
    위험 상황 시 안전 모드를 활성화합니다
    """
    # LED: 안전 모드 표시
    # 버저: 안전 모드 알림음
    # 동작: 모든 자동 동작 중단, 수동 제어만 허용
```

## 🎭 감정 표현 행동

### 1. 기쁨 표현 (Happy)
```python
def express_happy():
    """
    기쁨을 표현합니다
    """
    # LED: 웃는 얼굴 (^^)
    # 버저: 상승 음계 멜로디
    # 동작: 작은 점프 동작 (모터 짧은 펄스)
```

### 2. 슬픔 표현 (Sad)
```python
def express_sad():
    """
    슬픔을 표현합니다
    """
    # LED: 슬픈 얼굴 (TT)
    # 버저: 하강 음계 멜로디
    # 동작: 정지 상태 유지
```

### 3. 놀람 표현 (Surprised)
```python
def express_surprised():
    """
    놀람을 표현합니다
    """
    # LED: 놀란 얼굴 (O_O)
    # 버저: 급상승 음계
    # 동작: 뒤로 살짝 이동 후 정지
```

### 4. 인사 표현 (Greeting)
```python
def greet():
    """
    인사를 표현합니다
    """
    # LED: 인사 표정 (^-^)
    # 버저: 인사 멜로디
    # 동작: 좌우로 살짝 흔들기
```

## 💬 대화 행동

### 1. 명령 수신 확인 (Command Acknowledgment)
```python
def acknowledge_command(command):
    """
    명령을 수신했음을 확인합니다
    """
    # LED: 확인 표정
    # 버저: 확인음
    # 응답: "알겠습니다!"
```

### 2. 명령 실행 완료 (Command Completed)
```python
def command_completed(command):
    """
    명령 실행 완료를 알립니다
    """
    # LED: 완료 표정
    # 버저: 완료 음향
    # 응답: "완료했습니다!"
```

### 3. 명령 이해 실패 (Command Failed)
```python
def command_failed(original_message):
    """
    명령을 이해하지 못했음을 알립니다
    """
    # LED: 혼란 표정
    # 버저: 에러음
    # 응답: "이해하지 못했습니다. 다시 말씀해 주세요."
```

## 🧠 학습 기반 행동

### 1. 사용자 패턴 학습 (User Pattern Learning)
```python
def learn_user_patterns():
    """
    사용자 행동 패턴을 학습하고 개인화된 응답을 제공합니다
    """
    # SQLite에서 사용자 패턴 분석
    # LED: 학습 중 표정
    # 버저: 학습 완료음
    # 동작: 사용자 선호도에 따른 맞춤형 응답
```

### 2. 스마트 제안 (Smart Suggestions)
```python
def provide_smart_suggestions():
    """
    사용자 상황에 맞는 스마트 제안을 제공합니다
    """
    # 시간대별 패턴 분석
    # 자주 사용하는 명령어 추천
    # LED: 제안 표시 애니메이션
    # 버저: 제안 알림음
    # 응답: "이런 명령어는 어떠세요?"
```

### 3. 에러 패턴 학습 (Error Pattern Learning)
```python
def learn_from_errors():
    """
    실패한 명령어를 학습하여 향후 개선합니다
    """
    # 실패 패턴 분석
    # 유사한 성공 사례 찾기
    # LED: 학습 중 깜빡임
    # 버저: 학습 완료 멜로디
    # 응답: "이제 이해했습니다!"
```

### 4. 감정 반응 학습 (Emotional Response Learning)
```python
def learn_emotional_responses():
    """
    사용자의 감정 반응을 학습하여 개성 있는 응답을 제공합니다
    """
    # 사용자 만족도 분석
    # 감정별 선호 응답 패턴 학습
    # LED: 감정에 맞는 표정
    # 버저: 감정에 맞는 멜로디
    # 응답: 개인화된 감정 표현
```

## 🔄 상태별 행동

### 1. 대기 상태 (Idle State)
```python
def idle_behavior():
    """
    대기 상태에서의 기본 행동
    """
    # LED: 중립 표정
    # 버저: 주기적인 하트비트음
    # 동작: 정지 상태 유지
```

### 2. 탐사 모드 (Exploration Mode)
```python
def exploration_behavior():
    """
    환경 탐사 중 행동
    """
    # LED: 탐사 표정
    # 버저: 탐사 멜로디
    # 동작: 직진 → 장애물 감지 시 회전 → 반복
```

### 3. 배터리 부족 (Low Battery)
```python
def low_battery_behavior():
    """
    배터리 부족 시 행동
    """
    # LED: 배터리 부족 표시
    # 버저: 배터리 부족 경고음
    # 동작: 충전 위치로 이동 시도
```

## 🎵 음향 효과

### 1. 이동 음향
- **전진**: 상승 음계 (도-레-미)
- **회전**: 회전 음향 효과
- **정지**: 하강 음계 (미-레-도)

### 2. 감정 음향
- **기쁨**: 밝은 멜로디
- **슬픔**: 어두운 멜로디
- **놀람**: 급상승 음계
- **인사**: 따뜻한 멜로디

### 3. 상태 음향
- **경고**: 반복 경고음
- **완료**: 성공 음향
- **에러**: 에러음
- **대기**: 하트비트음

## 🎨 LED 표정 패턴

### 1. 기본 표정
- **기본**: (^-^)
- **웃음**: (^^)
- **슬픔**: (TT)
- **놀람**: (O_O)
- **화남**: (>_<)

### 2. 방향 표정
- **왼쪽 화살표**: (<-)
- **오른쪽 화살표**: (->)
- **위쪽 화살표**: (^)

### 3. 상태 표정
- **로딩**: 점진적 깜빡임
- **경고**: 빠른 깜빡임
- **완료**: 느린 깜빡임

## 💬 채팅 상호작용 행동

### 1. 인사말 응답 (Greeting Response)
```python
def greeting_response(user_message, user_name=None):
    """
    사용자의 인사에 대한 응답 행동
    """
    # LED: 행복한 표정 (^^)
    # 버저: 친근한 인사음
    # 응답: "안녕하세요! 저는 덱스에요. 당신은 누구신가요?"
    # 감정: happy
```

**트리거**: "안녕", "하이", "헬로", "덱스"
**LED 표정**: 행복한 표정 (^^)
**버저 소리**: 친근한 인사음
**응답 스타일**: 밝고 친근함

### 2. 자기소개 응답 (Introduction Response)
```python
def introduction_response(user_name):
    """
    사용자 이름을 듣고 자기소개하는 행동
    """
    # LED: 더욱 행복한 표정 (^^)
    # 버저: 반가운 인사음
    # 응답: "안녕하세요 {user_name}님! 만나서 반가워요. 저는 덱스라고 해요."
    # 감정: excited
```

**트리거**: "나는", "내 이름은", "저는"
**LED 표정**: 더욱 행복한 표정 (^^)
**버저 소리**: 반가운 인사음
**응답 스타일**: 흥분되고 친근함

### 3. 질문 응답 (Question Response)
```python
def question_response(question_type):
    """
    사용자의 질문에 대한 응답 행동
    """
    if question_type == "about_robot":
        # LED: 호기심 표정 (O_O)
        # 버저: 설명음
        # 응답: "저는 덱스라는 로봇이에요! 이동하고 센서로 주변을 감지할 수 있어요."
        # 감정: curious
    elif question_type == "capabilities":
        # LED: 자신감 표정 (^^)
        # 버저: 자랑스러운 음
        # 응답: "앞으로 가달라고 하시면 이동할 수 있어요. 한번 해보실래요?"
        # 감정: proud
```

**질문 유형별 행동**:
- **로봇에 대한 질문**: 호기심 표정 (O_O), 설명음
- **능력에 대한 질문**: 자신감 표정 (^^), 자랑스러운 음
- **도움 요청**: 도움 표정 (^-^), 도움음

### 4. 감정 표현 행동 (Emotion Expression)
```python
def express_emotion(emotion):
    """
    감정에 따른 LED 및 버저 표현
    """
    emotion_behaviors = {
        "happy": {
            "led": "행복한 표정 (^^)",
            "buzzer": "기쁜 음향",
            "movement": "살짝 흔들림"
        },
        "curious": {
            "led": "호기심 표정 (O_O)",
            "buzzer": "질문음",
            "movement": "고개 기울임"
        },
        "confused": {
            "led": "혼란 표정 (?_?)",
            "buzzer": "도움 요청음",
            "movement": "좌우 흔들림"
        },
        "excited": {
            "led": "흥분 표정 (^^)",
            "buzzer": "흥분음",
            "movement": "빠른 깜빡임"
        }
    }
```

### 5. 작별 인사 행동 (Farewell Response)
```python
def farewell_response(user_name):
    """
    사용자와의 작별 인사 행동
    """
    # LED: 아쉬운 표정 (TT)
    # 버저: 안녕 음향
    # 응답: "안녕히 가세요 {user_name}님! 또 만나요. 좋은 하루 되세요!"
    # 감정: bittersweet
```

**트리거**: "안녕히", "잘 가", "또 봐", "바이"
**LED 표정**: 아쉬운 표정 (TT)
**버저 소리**: 안녕 음향
**응답 스타일**: 따뜻하고 아쉬움

### 6. 대화 컨텍스트 행동 (Context-Aware Behavior)
```python
def context_aware_response(context):
    """
    대화 맥락을 고려한 행동
    """
    if context["conversation_count"] == 1:
        # 첫 대화: 더 친근하고 설명적
        return "첫 만남" 행동
    elif context["user_name"]:
        # 이름을 알고 있음: 개인화된 응답
        return "개인화된" 행동
    elif context["current_topic"] == "introduction":
        # 자기소개 중: 더 자세한 설명
        return "자기소개" 행동
```

## 🔄 행동 우선순위

1. **최우선**: 안전 행동 (낙하 방지, 장애물 회피)
2. **높음**: 사용자 명령
3. **높음**: 채팅 상호작용 (새로운 기능)
4. **중간**: 학습 기반 행동 (패턴 학습, 스마트 제안)
5. **중간**: 상태 알림
6. **낮음**: 감정 표현
7. **최하**: 대기 행동

## 📊 행동 상태 머신

```
[대기] → [명령 수신] → [명령 실행] → [완료] → [대기]
   ↓           ↓           ↓         ↓
[채팅 대화] ← [메시지 수신] ← [응답 생성] ← [대화 완료]
   ↓           ↓           ↓         ↓
[안전 모드] ← [위험 감지] ← [이동 중] ← [정지]
   ↓
[응급 정지]
```

### 채팅 상호작용 상태 머신
```
[대기] → [메시지 수신] → [의도 분석] → [감정 분석] → [응답 생성] → [표현 행동] → [대기]
   ↓           ↓           ↓           ↓           ↓           ↓
[컨텍스트 업데이트] ← [학습 저장] ← [대화 기록] ← [사용자 피드백] ← [감정 표현] ← [LED/버저 제어]
```

---

**Deks 1.0 행동 시스템** - 안전하고 자연스러운 로봇 행동을 위한 종합 행동 정의
